$schema: https://azuremlschemas.azureedge.net/latest/pipelineJob.schema.json
type: pipeline

description: Tomas lendingclub demo pipeline

display_name: lendingclub-demo-pipeline
experiment_name: lendingclub-demo-experiment

settings:
  default_datastore: azureml:workspaceblobstore
  default_compute: azureml:managed-cluster

jobs:
  prepare_data:
    inputs:
      raw_data:
        type: uri_file
        path: azureml:lending_club_raw:1
        mode: ro_mount 
    type: command
    component: azureml:lending_club_process_data@latest
    outputs:
      processed_data:
  split_and_scale:
    inputs:
      data:
        type: uri_file
        path: ${{parent.jobs.prepare_data.outputs.processed_data}}
        mode: ro_mount 
      label_name: loan_repaid
      file_name: landing_club_processed.csv
    type: command
    component: azureml:split_and_scale@latest
    outputs:
      datasets:
  train:
    inputs:
      data:
        type: uri_file
        path: ${{parent.jobs.split_and_scale.outputs.datasets}}
        mode: ro_mount 
    type: command
    component: azureml:lending_club_train@latest
    outputs:
      model:
  # register_model:
  #   inputs:
  #     model_name: landingclub-model
  #     model_path:
  #       type: uri_folder
  #       path: ${{parent.jobs.train.outputs.model}}
  #       mode: ro_mount 
  #   component: azureml:register_model@latest
  #   type: command